<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Portal Keuangan Proyek</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body data-api="https://script.google.com/macros/s/AKfycbwLn3bi3DxH4T4rBouQdnXbSnfR6KF2dviiL2lEWAzHZb0h6ABOzne0K3k7RClckJJQ/exec">

  <!-- ===== App Shell ===== -->
  <div id="app-shell">
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-head">
            <img class="brand-logo-sidebar" src="logo-main.png" alt="Logo">
            <div class="brand-text-sidebar">
                <strong>Portal Keuangan</strong>
                <small>Proyek Anda</small>
            </div>
        </div>
        <nav class="nav-container">
            <button class="nav-item active" data-nav="dashboard"><span class="material-symbols-outlined">dashboard</span><span class="nav-text">Dashboard</span></button>
            <div class="nav-group">
                <button class="nav-item" data-expand="input"><span class="material-symbols-outlined">edit_document</span><span class="nav-text">Input Data</span><span class="chev material-symbols-outlined">expand_more</span></button>
                <div class="subnav">
                    <button class="sub-item" data-nav="input-pemasukan">Pemasukan</button>
                    <button class="sub-item" data-nav="input-operasional">Operasional</button>
                    <button class="sub-item" data-nav="input-material">Material</button>
                    <button class="sub-item" data-nav="pembayaran">Pembayaran</button>
                    <button class="sub-item" data-nav="absensi">Absensi</button>
                </div>
            </div>
            <div class="nav-group">
                <button class="nav-item" data-expand="monitor"><span class="material-symbols-outlined">monitoring</span><span class="nav-text">Monitoring</span><span class="chev material-symbols-outlined">expand_more</span></button>
                <div class="subnav">
                    <button class="sub-item" data-nav="monitor-arus-kas">Arus Kas Total</button>
                    <button class="sub-item" data-nav="monitor-material">Kas Material</button>
                    <button class="sub-item" data-nav="monitor-operasional">Kas Operasional</button>
                    <button class="sub-item" data-nav="monitor-upah">Kas Upah/Gaji</button>
                </div>
            </div>
        </nav>
        <div class="sidebar-footer"><button id="btnLogout" class="nav-item danger"><span class="material-symbols-outlined">logout</span><span class="nav-text">Keluar</span></button></div>
    </aside>

    <div class="content-wrapper">
      <header class="main-header">
        <button id="btnOpenNav" class="icon-btn" aria-label="Menu"><span class="material-symbols-outlined">menu</span></button>
        <div class="search-container"><span class="material-symbols-outlined">search</span><input id="qGlobal" type="search" placeholder="Cari transaksiâ€¦"></div>
        <div id="connection-status" class="connection-status">
            <div class="indicator"></div>
            <span class="status-text"></span>
        </div>
      </header>
      <div class="page-container">
        <!-- DASHBOARD -->
        <main id="page-dashboard" class="page active">
          <section class="kpi-grid">
            <article class="kpi"><p>Pendapatan</p><h3 id="kpiIncome">Memuat...</h3></article>
            <article class="kpi"><p>Material</p><h3 id="kpiMaterial">Memuat...</h3></article>
            <article class="kpi"><p>Gaji/Upah</p><h3 id="kpiGaji">Memuat...</h3></article>
            <article class="kpi"><p>Kas</p><h3 id="kpiKas">Memuat...</h3></article>
          </section>
          <section class="card">
            <div class="card-header"><h4>Pengeluaran 7 Hari Terakhir</h4><button id="btnRefresh" class="icon-btn" aria-label="Refresh Data"><span class="material-symbols-outlined">refresh</span></button></div>
            <div class="chart-container"><canvas id="chart7"></canvas></div>
          </section>
        </main>
        
        <!-- All other pages will be injected here by JS -->

      </div>
    </div>
  </div>
  
  <div id="scrim" class="scrim"></div>
  
  <!-- Pop-ups -->
  <div id="popup-container" class="popup-container"><div class="popup-content"><span id="popup-icon"></span><p id="popup-message"></p></div></div>
  <div id="kreditor-popup" class="modal-bg hidden">
    <div class="modal-content">
      <div class="modal-header"><h4>Tambah Kreditor</h4><button class="modal-close-btn">&times;</button></div>
      <div class="modal-body">
        <form id="form-add-kreditor" class="form">
          <div class="form-group"><label for="kreditor-name">Nama Kreditor/Vendor</label><input id="kreditor-name" name="nama" type="text" required></div>
          <button type="submit" class="btn btn-primary w-full">Simpan</button>
        </form>
      </div>
    </div>
  </div>
  <div id="worker-popup" class="modal-bg hidden">
      <div class="modal-content">
          <div class="modal-header"><h4>Manajemen Pekerja</h4><button class="modal-close-btn">&times;</button></div>
          <div class="modal-body">
              <form id="form-add-worker" class="form">
                  <h5>Tambah Pekerja Baru</h5>
                  <div class="form-group"><label for="worker-name">Nama Pegawai</label><input id="worker-name" name="nama" type="text" required></div>
                  <div class="form-group"><label for="worker-profesi">Profesi</label><input id="worker-profesi" name="profesi" type="text" required></div>
                  <div class="form-group"><label for="worker-upah">Upah Harian (Rp)</label><input id="worker-upah" name="upah" type="number" min="0" required></div>
                  <button type="submit" class="btn btn-primary w-full">Tambah</button>
              </form>
              <div class="card" style="margin-top: 1.5rem;">
                  <h5 class="card-header">Daftar Pekerja</h5>
                  <div id="worker-list" class="table-container"></div>
              </div>
          </div>
      </div>
  </div>

  <!-- PENTING: Library untuk Database Offline -->
  <script src="https://cdn.jsdelivr.net/npm/idb@7/build/umd.js"></script>
  
  <script src="script.js"></script>
</body>
</html>

